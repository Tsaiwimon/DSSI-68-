{% load static %}
{% load humanize %}

<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ชำระเงินสำเร็จ Order #{{ order.id }} | Glam & Borrow</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    body { background-color: #f8fafc; font-family: 'Sarabun', sans-serif; }
    .thin-scroll::-webkit-scrollbar { width: 6px; }
    .thin-scroll::-webkit-scrollbar-track { background: #f8fafc; }
    .thin-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
  </style>
</head>

<body class="h-screen w-screen overflow-hidden flex flex-col text-gray-700 bg-gray-50">

  <header class="bg-gradient-to-r from-pink-200 via-yellow-100 to-blue-200 shadow-md w-full flex-none z-50">
      <div class="flex justify-between items-center px-7 py-7 max-w-7xl mx-auto w-full">
          <div class="flex items-center gap-4">
             <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-green-500 shadow-sm border border-green-100">
                <i class="fa-solid fa-circle-check text-xl"></i>
             </div>
             <div>
                <h1 class="text-xl font-bold text-gray-800 tracking-tight">ชำระเงินสำเร็จ</h1>
                <p class="text-xs text-gray-600 font-medium opacity-80">ขอบคุณที่ใช้บริการของเรา</p>
             </div>
          </div>
          <a href="{% url 'dress:home' %}" class="bg-white/80 hover:bg-white text-gray-700 px-4 py-2 rounded-full font-bold shadow-sm hover:shadow transition flex items-center gap-2 text-sm">
            <i class="fa-solid fa-house"></i> หน้าหลัก
          </a>
      </div>
  </header>

  <main class="flex-grow flex items-center justify-center p-4 bg-gray-50">
    <div class="max-w-5xl w-full grid grid-cols-1 lg:grid-cols-2 gap-6 h-full max-h-[680px]">
      
      <div class="lg:order-2 bg-white rounded-2xl shadow-xl border border-green-100 flex flex-col overflow-hidden h-full relative z-20">
            <div class="h-2 bg-gradient-to-r from-green-400 to-emerald-500 w-full flex-none"></div>

            <div class="flex-grow flex flex-col items-center justify-center p-8 text-center">
                
                <div class="w-24 h-24 bg-green-50 rounded-full flex items-center justify-center mb-6 animate-bounce shadow-green-100 shadow-lg">
                    <i class="fa-solid fa-check text-5xl text-green-500"></i>
                </div>

                <h2 class="text-2xl font-bold text-gray-800 mb-2">ได้รับยอดเงินเรียบร้อยแล้ว</h2>
                <p class="text-gray-500 text-sm mb-8">ระบบได้บันทึกคำสั่งซื้อของคุณแล้ว<br>ร้านค้ากำลังเตรียมจัดส่งสินค้า</p>

                <div class="bg-gray-50 rounded-xl p-5 border border-gray-100 w-full max-w-sm space-y-3 shadow-inner">
                    <div class="flex justify-between items-center border-b border-gray-200 pb-2 border-dashed">
                        <span class="text-xs text-gray-500 font-medium">หมายเลขคำสั่งซื้อ</span>
                        <span class="text-sm font-bold text-gray-800">#{{ order.id }}</span>
                    </div>
                    <div class="flex justify-between items-center border-b border-gray-200 pb-2 border-dashed">
                        <span class="text-xs text-gray-500 font-medium">วันที่ทำรายการ</span>
                        <span class="text-xs font-medium text-gray-700">{% now "j M Y, H:i" %}</span>
                    </div>
                     <div class="flex justify-between items-center border-b border-gray-200 pb-2 border-dashed">
                        <span class="text-xs text-gray-500 font-medium">ช่องทางชำระเงิน</span>
                        <span class="text-xs bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 font-bold">QR Payment</span>
                    </div>
                    
                    <div class="pt-2 flex justify-between items-end">
                        <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">ยอดสุทธิ</span>
                        <span class="text-2xl font-bold text-green-600">฿{{ order.grand_total|floatformat:2|intcomma }}</span>
                    </div>
                </div>
            </div>

            <div class="p-5 bg-gray-50 border-t border-gray-100 flex-none grid grid-cols-2 gap-3">
                 <a href="{% url 'dress:home' %}" class="bg-white border border-gray-200 text-gray-600 hover:text-gray-800 hover:bg-gray-50 font-bold py-3 rounded-xl transition flex justify-center items-center gap-2 text-sm shadow-sm">
                    <i class="fa-solid fa-bag-shopping"></i> ช้อปต่อ
                 </a>
                 <a href="{% url 'dress:order_detail' order.id %}" class="bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 rounded-xl transition flex justify-center items-center gap-2 text-sm shadow-lg shadow-gray-300">
                    <i class="fa-solid fa-file-invoice"></i> ดูรายละเอียด
                 </a>
            </div>
      </div>

      <div class="lg:order-1 bg-white rounded-2xl shadow-xl border border-gray-100 flex flex-col overflow-hidden h-full">
            <div class="bg-gray-50 px-6 py-4 border-b border-gray-200 border-dashed flex justify-between items-center flex-none">
                <div>
                    <h3 class="font-bold text-gray-800"><i class="fa-solid fa-receipt mr-2 text-gray-400"></i>สรุปรายการสินค้า</h3>
                </div>
                <span class="bg-gray-200 text-gray-600 px-2 py-1 rounded text-xs font-bold">
                    {{ items|length }} รายการ
                </span>
            </div>

            <div class="p-5 flex-grow overflow-y-auto thin-scroll space-y-4">
                {% for item in items %}
                <div class="flex items-start bg-white p-2 rounded-lg border-b border-gray-100 last:border-0 pb-3 last:pb-0">
                    
                    <div class="w-14 h-14 bg-gray-100 rounded-lg flex-shrink-0 mr-3 overflow-hidden border border-gray-200">
                        {% if item.dress.image %}
                            <img src="{{ item.dress.image.url }}" class="w-full h-full object-cover">
                        {% else %}
                            <div class="w-full h-full flex items-center justify-center text-gray-300"><i class="fa-solid fa-image"></i></div>
                        {% endif %}
                    </div>
                    
                    <div class="flex-grow pt-0.5 min-w-0">
                        <div class="flex justify-between items-start">
                             <h4 class="text-sm font-bold text-gray-800 truncate pr-2">{{ item.dress.name }}</h4>
                             
                             <div class="text-right flex-shrink-0">
                                <span class="text-sm font-bold text-gray-800">
                                    ฿{{ item.line_total|default:0|floatformat:2|intcomma }}
                                </span>
                             </div>
                        </div>
                        
                        <div class="flex flex-wrap items-center gap-2 mt-1">
                             <span class="text-[10px] text-gray-500 bg-gray-50 px-1.5 py-0.5 rounded border border-gray-100">
                                จำนวน: x{{ item.qty|default:1 }}
                             </span>
                             {% if item.dress.shop %}
                             <span class="text-[10px] text-blue-500 bg-blue-50 px-1.5 py-0.5 rounded border border-blue-100">
                                <i class="fa-solid fa-store mr-1"></i>{{ item.dress.shop.shop_name|default:item.dress.shop.name }}
                             </span>
                             {% endif %}
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="text-center py-10 text-gray-400 text-sm">ไม่มีรายการสินค้า</div>
                {% endfor %}
            </div>

            <div class="px-6 py-5 bg-gray-50 border-t border-gray-200 flex-none space-y-2">
                <div class="space-y-1">
                    {% if order.rental_total %}
                    <div class="flex justify-between text-gray-600 text-xs">
                        <span>ค่าเช่าสินค้า</span>
                        <span class="font-medium">฿{{ order.rental_total|floatformat:2|intcomma }}</span>
                    </div>
                    {% endif %}
                    
                    {% if order.deposit_total %}
                    <div class="flex justify-between text-gray-600 text-xs">
                        <span>ค่ามัดจำ (ได้รับคืน)</span>
                        <span class="font-medium">฿{{ order.deposit_total|floatformat:2|intcomma }}</span>
                    </div>
                    {% endif %}
                    
                    {% if order.shipping_fee %}
                    <div class="flex justify-between text-gray-600 text-xs">
                        <span>ค่าจัดส่ง</span>
                        <span class="font-medium">฿{{ order.shipping_fee|floatformat:2|intcomma }}</span>
                    </div>
                    {% endif %}
                </div>

                <div class="border-t border-gray-200 border-dashed pt-2 mt-2">
                     <div class="flex justify-between items-center">
                        <span class="text-gray-800 font-bold text-sm">ยอดรวมทั้งสิ้น</span>
                        <span class="text-lg font-bold text-pink-600">฿{{ order.grand_total|floatformat:2|intcomma }}</span>
                     </div>
                </div>
            </div>
      </div>

    </div>
  </main>

</body>
</html>